[DEFAULT]
bantime.increment = true

# "bantime.rndtime" is the max number of seconds using for mixing with random time
# to prevent "clever" botnets calculate exact time IP can be unbanned again:
bantime.rndtime = 2048

bantime.multipliers = 1 5 30 60 300 720 1440 2880

# [444-jail]
# enabled = true
# ignoreip = <hidden>
# filter = nginx-444-common
# action = iptables-multiport[name=nginx-ban, port="http,https"]
# logpath = /var/log/nginx/file1.access.log
#           /var/log/nginx/file2.access.log

# maxretry = 1
# findtime = 21600
# bantime = 2592000

# [ip-jail] 
# #bans IPs trying to connect via VM IP address instead of DNS record
# enabled = true
# ignoreip = <hidden>
# filter = ip-filter
# action = iptables-multiport[name=nginx-ban, port="http,https"]
# logpath = /var/log/nginx/file1.access.log
# maxretry = 0
# findtime = 21600
# bantime = 2592000

[ssh-jail]
enabled = true
# ignoreip = <hidden>
chain = INPUT
port = ssh
filter = sshd[mode=aggressive]
logpath = /var/log/auth.log
maxretry = 3
findtime = 1d
bantime = 604800

# [custom-app-jail]
# enabled = true
# ignoreip = <hidden>
# filter = nginx-custom-common
# action = iptables-multiport[name=nginx-ban, port="http,https"]
# logpath = /var/log/nginx/file1.access.log
#           /var/log/nginx/file2.access.log
# maxretry = 15
# findtime = 900
# bantime = 3600
